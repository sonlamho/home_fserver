
{% extends 'base.html' %}

{% set foldername = NAV.get_fname_from_path(relpath) %}
{% block title %} FS | {{ foldername }}  {% endblock %}

{% block header %}
{% endblock %}

{% block content %}
<div>

{% set good_relpath = relpath.strip('/') %}
<h3>
{% if good_relpath %}
  {{ foldername }}
{% else %}
  {{ 'Root folder' }}
{% endif %}
</h3>

<hr>
<table id="files_table" style="width:100%;text-align:left;" class="display dataTable">
  <thead>
    <tr><th> </th><th>Name</th><th>Size</th></tr>
  </thead>
  <tbody>
  {% if good_relpath %}
    <tr>
      <td>üìÅ</td>
      <td>
        {% if secret %}
          <a href={{ url_for('secret_index_path', relpath=NAV.get_dotdot(good_relpath)) }}>..</a>
        {% else %}
          <a href={{ url_for('fs.index_path', relpath=NAV.get_dotdot(good_relpath)) }}>..</a>
        {% endif %}
      </td>
      <td></td>
    </tr>
  {% endif %}
  {% for is_folder, fname, size in NAV.get_folder_items(relpath) %}
    <tr>
      {% if is_folder %}
        {% set icon = 'üìÅ' %}
      {% else %}
        {% set icon = '' %}
      {% endif %}
      <td> {{ icon }}</td>
      <td>
        {% if secret %}
          <a href={{ url_for('secret_index_path', relpath='/'.join([relpath, fname]).strip(' /')) }}>{{ fname }}</a>
        {% else %}
          <a href={{ url_for('fs.index_path', relpath='/'.join([relpath, fname]).strip(' /')) }}>{{ fname }}</a>
        {% endif %}
      </td>
      <td> {{ size }}</td>
    </tr>
  {% endfor %}
  </tbody>
</table>

<hr>

<div>
  <h4> Upload </h4>
  <form enctype="multipart/form-data" method="post">
    <input type="file" name="file" id="file" required>
    <input type="submit" name="upload" value="Upload!">
  </form>
</div>

<hr>
{% if (not secret) and ALLOW_SECRET %}
  <div style="text-align:right;">
  <a href={{ url_for('secret_index_path', relpath='') }}>Secret path</a>
  </div>
{% endif %}

</div>

<script>
$(document).ready( function () {
  $('#files_table').DataTable({
    "paging": false, "searching": true,  "order": [[0, "desc"], [ 1, "asc" ]]
  });
} );
</script>

{% endblock %}
